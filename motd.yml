---
- name: Criar MOTD personalizado para o usu√°rio 'suporte'
  hosts: all
  become: true

  tasks:
    - name: Copiar /etc/profile.d/motd.sh
      ansible.builtin.copy:
        dest: /etc/profile.d/motd.sh
        owner: root
        group: root
        mode: '0755'
        content: |-
          #!/bin/bash

          # Verifica se o usu√°rio √© "suporte"
          if [[ "$USER" == "suporte" ]]; then
              hostname=$(echo "$HOSTNAME")
              dominio=$(echo "$hostname" | tr '[:upper:]' '[:lower:]' | sed 's/^srv-//' | sed 's/-/./g')
              dominio="${dominio}.com.br"

              echo "===================================="
              echo " üñ•Ô∏è Servidor: $(hostname)"
              echo " üìÖ Data: $(date)"
              echo " ‚è≥ Uptime: $(uptime -p)"
              echo " üìä Usu√°rios logados: $(who | wc -l)"
              echo " üåê Espa√ßo livre no disco: $(df -h / | tail -1 | awk '{print $4}')"
              echo " üì¶ Vers√£o USCall: $(rpm -q uscall)"
              echo " üè∑Ô∏è DNS: $dominio"
              echo "===================================="
          fi
